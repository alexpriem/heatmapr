<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <LINK href="css/style.css" rel="stylesheet" type="text/css">
  <script src="lib/jquery-2.0.3.min.js"  type="text/javascript"> </script> 
    <script src="lib/d3.v3.min.js"  type="text/javascript"> </script> 
  <script src="js/data.js" type="text/javascript"> </script> 
  <script src="js/colormaps.js" type="text/javascript"> </script> 
  <script src="js/ui.js" type="text/javascript"> </script> 

</head>


<body>
<p>Heatmap:</p>
<div id="controls" class="leftbox">
<ul id="sel_colormap">
</ul>
<ul id="sel_size" class="selbox">
</ul>
<ul id="sel_transform" class="selbox">
  <li class="sel_heading"> Transform: </li>
  <li class="transformname" data-transform="linear"> linear</li>
  <li class="transformname" data-transform="sqrt"> sqrt</li>
  <li class="transformname" data-transform="log2"> log2</li>
  <li class="transformname" data-transform="log10"> log10</li>  
</ul>
<ul id="sel_swap" class="selbox">
  <li class="sel_heading"> Inversions:</li>
  <li class="swapname" id="inv_x"> invert X </li>
  <li class="swapname" id="inv_y"> invert Y </li>
  <li class="swapname" id="inv_xy"> swap X/Y </li>
  <li class="swapname" id="inv_grad" > invert gradient</li>
</ul>
</div>
<div class="rightbox">
<div id="canvasdiv" class="rightbox"> 
  <canvas id="heatmap_canvas"> </canvas>
  <svg id="heatmap_svg"> </svg>
</div>

</div>



<script type="text/javascript">


// https://developer.mozilla.org/en-US/docs/Web/API/FileReader#readAsDataURL%28%29
  
  console.log("init:",width,height);
  var c=document.getElementById("heatmap_canvas");
  c.setAttribute("width", width);
  c.setAttribute("height", width);
  var s=document.getElementById("heatmap_svg");
  s.setAttribute("width", width*2+100);
  s.setAttribute("height", height+100);
  
  var ctx = c.getContext('2d');  
  



  //console.log(colormaps);
  init_colormaps();
  init_sizes();
  init_gradient_transforms();
  init_data_transforms();




  var chart = d3.select("#heatmap_svg");

  
  //console.log(chart);
  console.time("start")








var delta=maxval-minval;
// first, create a new ImageData to contain our pixels
var imgData = ctx.createImageData(width, height); // width x height
var mapdata = imgData.data;
var val=0;
var color=[];

// copy img byte-per-byte into our ImageData
draw_heatmap();
draw_axes ();
draw_colormap();


//console.log(data);
console.timeEnd("timing foo")
// now we can draw our imagedata onto the canvas
ctx.putImageData(imgData, 0, 0);
  </script>
</body>
</html>