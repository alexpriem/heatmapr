<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
  <meta content="utf-8" http-equiv="encoding">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
   
  <link href="css/style.css" rel="stylesheet" type="text/css">
  <script src="lib/jquery-2.0.3.min.js"  type="text/javascript"> </script> 
  <script src="lib/d3.v3.min.js"  type="text/javascript"> </script> 
  <script src="lib/chroma.min.js"  type="text/javascript"> </script> 
  <script src="js/data2.js" type="text/javascript"> </script> 
  <script src="js/colormaps.js" type="text/javascript"> </script> 
  <script src="js/ui.js" type="text/javascript"> </script> 
  <script src="lib/pixastic.custom.js" type="text/javascript"> </script>   
</head>


<body>
<p class="sel_heading">Heatmap:</p>
<div id="controls" class="leftbox">
<ul id="sel_colormap">
</ul>
<ul id="sel_size" class="selbox">
</ul>
<ul id="sel_transform" class="selbox">
  <li class="sel_heading"> Transform: </li>
  <li class="transformname" id="trans_linear" data-transform="linear"> linear</li>
  <li class="transformname" id="trans_sqrt" data-transform="sqrt"> sqrt</li>
  <li class="transformname" id="trans_log2" data-transform="log2"> log2</li>
  <li class="transformname" id="trans_log10" data-transform="log10"> log10</li>  
</ul>
<ul id="sel_swap" class="selbox">
  <li class="sel_heading"> Inversions:</li>
  <li class="swapname" id="inv_x"> invert X </li>
  <li class="swapname" id="inv_y"> invert Y </li>
  <li class="swapname" id="inv_xy"> swap X/Y </li>
  <li class="swapname" id="inv_grad" > invert gradient</li>
</ul>
<ul id="sel_pixastic" class="selbox">
  <li class="sel_heading"> Image-manipulation:</li>
  <li class="man" id="sharpen"> Sharpen</li>
  <li class="man" id="denoise"> Denoise</li>
  <li class="man" id="edge"> Edge</li>
  <li class="man" id="pointilize"> Pointilize</li>
  <li class="man" id="blur"> Blur</li>
  <li class="man" id="lighten"> lighten</li>
  </ul>
</div>

<div id="canvasdiv" class="rightbox"> 
  <canvas id="heatmap_canvas" > </canvas>
  <svg id="heatmap_svg" > </svg>  
  <div>
  <div id="colormap_max">
      <input type='text' id='edit_gradmax'name='gradmax' value='2000' size='4'>
  </div>
  <div id="colormap_steps">
      <input type='text' id='edit_gradsteps'name='gradsteps' value='20' size='4'>
  </div>
  <div id="colormap_min">
      <input type='text' id='edit_gradmin'name='gradmin' value='0' size='4'>  
  </div>
</div>
</div>

</div>



<script type="text/javascript">


// https://developer.mozilla.org/en-US/docs/Web/API/FileReader#readAsDataURL%28%29
  
  console.log("init:",imgwidth,imgheight);
  var c=document.getElementById("heatmap_canvas");
  c.setAttribute("width", imgwidth);
  c.setAttribute("height", imgwidth);
  var s=document.getElementById("heatmap_svg");
  s.setAttribute("width", imgwidth*2+100);
  s.setAttribute("height", imgheight+100);
  
  var ctx = c.getContext('2d');  
  
  init_colormaps();
  init_sizes();
  init_gradient_transforms();
  init_data_transforms();
  init_manipulation();
  init_databuffers();
  init_colormap_inputs();



 //console.clear(); 
   //console.profile("start");



// copy img byte-per-byte into our ImageData
draw_heatmap();
draw_axes ();
draw_colormap();


//console.log(data);
//console.profileEnd("timing");
// now we can draw our imagedata onto the canvas

//console.clear();
init_hist_xy();
Pixastic.debug=true;


  </script>
</body>
</html>
